\section{Microcontrollers Open Source Hardware (MOSH) and Sensor Introduction}

\subsection{Context}

After the week of labs at AIME to create a gas sensor, we had another course with the physical department on how to implement it in a bigger circuit with microcontrollers to collect and analysis its data. The objective of these courses were to create a datasheet for our sensor and to implement it with a microcontroller to create an application using a LoRa network able to display the results collected by the sensor.  

\subsection{Technical Aspects}

As I come from a network and computer science background I will focus on the high level of this course (creation of the application and microcontroller programming) and not treat the hardware part (creation of a PCB and circuit for the integration of the gas sensor).
\\\par

To begin our project, we first tried to connect an arduino to the Lora network. To do so, we used a RN2483 chip made by Microship which is a module that is able to communicate on a Lora network. As this chip only has tiny connectors, we needed to weld the component to a board that would have bigger connectors for the communication with the arduino.
\par
After this step, we were able to connect our arduino to the INSA's Lora network. For this, we used The Things Network library for arduino. For this, we had used the otaa authentication method. We got the device ID using the library and the application ID and key on the chirpstack website.
\par
With the established connection, we had to send data to the gateway in order to retrieve it and display it on a dashboard. As a first implementation of this application we connected an already made gas sensor which is the MQ-3B gas sensor to our arduino.
\par
After that we changed our arduino code to read the value from the gas sensor and send it to our LoRa network. As the max value we can get from the sensor is 1024, we encoded the information on 2 bytes before sending it.
\\\par

As the data is received by the LoRa network, we could visualize it on the chirpstack web page. However, it is not fited for a real usage of our gas sensor. A user of gas sensor would like to see the state of the sensor in real time in a dashboard. To do so, we decided to use node-red and MQTT.
\par
MQTT is a communication protocol particularly used for IoT devices. With this protocol there are two kind of nodes, the publisher and the subscribers. Publishers publish data in a topic and subscriber get all the data published on a specific topic. This protocol is supported by chirpstack which automatically upload the data it receives in a MQTT topic.
\par
Node-red is a web-browser flow editor that helps to easily connect flows. It provides visual coding with blocks for the ease of conception. It also implements dashboard library to display the data is user friendly dahsboards. We used a MQTT subscribe block to get the data from chirpstack that we pipe into a javascript function that decodes the data (it is encoded in base64 by chirpstack). Finally we send the decoded data to a dashboard block to visualize the data.
\par
To test our sensor, we putted hydroalcoholic gel near it to see if we could see it on our dashboard. This experience was a succes and we were able to see through the dashboard the increase of the gas rate near the sensor.
\\\par

During this course, we had also a small introduction on Open Source and free licenses explaining the difference between both and giving us some example of licenses like the creative commons licenses. 

\subsection{Skill Matrix}

\begin{itemize}
    \item Understand microcontroller archictecture and how to use them
    \item Be able to design data acquisition system (sensor, conditioner, microcontroller) with respect to the application
    \item Be able to design a shield to accommodate the gas sensor
    \item Be abe to design the sofware to use the gas sensor and its HMI
    \item Be able to combine all of the above mentioned components into a smart device
    \item Understand basic notions of sensors, data acquisition: physics, electronics and metrology point of view
    \item Be able to design the datasheet of the sensor manufactured
    \item Be able to design the electronic circuit of a sensorâ€™s signal conditioner (design + simulation)
\end{itemize}

As I do not come from a electronics or physics background, I do not have solid bases in the design of an electronic circuit or embedded programming. However this course was a good introduction to these concepts and it helped me understand these concepts. However, I cannot say that I master the skills mentioned in the matrix but I developed basic knowledge and a general point of view on how the design part of an electronic circuit is done in the industry.

\subsection{Analysis}

This course was really interesting as it used a lot of diverse skills from different background but everything was accessible for everybody. This really push forwards the skills of every students and favors the collaboration between group of student which come from different background. That way, I liked the fact that we had the opportunity to keep working with the sensor that we made during the lab at AIME, creating a PCB and a electrical circuit for it which is something that I never did before. 
\\\par
However, one drawback of this course is that all the labs were condensed into two weeks which represent a lot of hours on the same subject in a very short time. I think we would have better understood the concepts of this course if the labs were a little bit more spread in time. 
\\\par
I also really enjoyed the part of the course on licenses which is something that we never approached during our scholarship at INSA. We had the opportunity to understand what stands behind the term Open Source and what is a difference with a free license. 